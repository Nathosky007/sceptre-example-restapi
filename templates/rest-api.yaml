---
Parameters:
  Name:
    Type: String
  AuthorizationType: 
    Type: String
  HttpMethod:
    Type: String
  StageName:
    Type: String
Resources:
  restapitest:
    Type: AWS::ApiGateway::RestApi
    Properties:
      Name:
        Ref: Name
  
  restapiresource:
    Type: AWS::ApiGateway::Resource
    Properties:
      RestApiId: 
        !Ref restapitest
      ParentId: 
        !GetAtt  restapitest.RootResourceId
      PathPart: "stack"
    DependsOn:
      - restapitest

  restapimethod:
    Type: AWS::ApiGateway::Method
    Properties:
      AuthorizationType:
        Ref: AuthorizationType
      HttpMethod:
        Ref: HttpMethod
      ResourceId: 
        !Ref restapiresource 
      RestApiId: 
        !Ref restapitest
      Integration:
        Type: MOCK
    DependsOn:
      - restapitest
      - restapiresource
  
  restapideployment:
    Type: AWS::ApiGateway::Deployment
    Properties:
      RestApiId:
          Ref: restapitest
    DependsOn:
      - restapimethod
      - restapitest

  restapistage:
    Type: AWS::ApiGateway::Stage
    Properties:
      RestApiId:
        !Ref restapitest
      StageName: 
        Ref: StageName
      DeploymentId:
        !Ref restapideployment
    DependsOn:
      - restapideployment

Outputs:
  RestApiId:
    Value:
      Ref: restapitest
  RestApigetMethod:
    Value:
      Ref: restapimethod
  RestApiStage:
    Value:
      Ref: restapistage